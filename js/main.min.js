// @ts-nocheck
const DISCORD_ID="1372459254136705064",LANYARD_API=`https://api.lanyard.rest/v1/users/${DISCORD_ID}`,QUOTES_TXT="https://moonlightrblx.github.io/api/quotes.txt",POLL_INTERVAL=15e3,$=t=>document.querySelector(t),el=(t,e={},a=[])=>{const s=document.createElement(t);return Object.entries(e).forEach((([t,e])=>s.setAttribute(t,e))),(Array.isArray(a)?a:[a]).forEach((t=>{"string"==typeof t?s.appendChild(document.createTextNode(t)):t&&s.appendChild(t)})),s},formatElapsed=t=>{if(t<0)return"just now";const e=Math.floor(t/1e3),a=Math.floor(e/60),s=Math.floor(a/60),o=Math.floor(s/24);return o>0?`${o}d ${s%24}h`:s>0?`${s}h ${a%60}min`:a>0?`${a} min`:`${e} sec`},formatTimestamp=t=>new Date(t).toLocaleString(void 0,{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),shuffle=t=>{for(let e=t.length-1;e>0;e--){const a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t};let quotes=[],quoteIndex=0,quoteTimer=null;async function loadQuotes(){try{const t=await fetch(QUOTES_TXT,{cache:"no-cache"});if(!t.ok)throw new Error("quotes fetch failed");const e=await t.text();if(quotes=e.split(/\r?\n/).map((t=>t.trim())).filter(Boolean),!quotes.length)throw new Error("no quotes");shuffle(quotes),$("#quoteCount").textContent=`Quotes: ${quotes.length}`,showRandomQuote(!0)}catch(t){console.error("Quotes error",t),$("#quoteText").textContent="Could not load quotes."}}function showRandomQuote(t=!1){if(!quotes.length)return;quoteIndex=t?Math.floor(Math.random()*quotes.length):(quoteIndex+1)%quotes.length;const e=$("#quoteBox");e.classList.remove("fade-enter-active"),e.classList.add("fade-exit-active"),setTimeout((()=>{$("#quoteText").textContent=quotes[quoteIndex],e.classList.remove("fade-exit-active"),e.classList.add("fade-enter-active")}),180),quoteTimer&&clearInterval(quoteTimer),quoteTimer=setInterval(showRandomQuote,8e3)}let lastLanyardData=null;async function fetchLanyard(){try{const t=await fetch(LANYARD_API,{cache:"no-store"});if(!t.ok)throw new Error("Lanyard failed: "+t.status);const{data:e}=await t.json();if(!e)throw new Error("Malformed payload");lastLanyardData=e,updateProfileUI(e),$("#lastUpdated").textContent="Last updated: "+(new Date).toLocaleTimeString()}catch(t){console.error("Lanyard error",t),$("#statusText").textContent="Offline",$("#statusDot").style.background="gray"}}function avatarUrlFromLanyard(t){if(!t)return"";const{id:e,avatar:a,discriminator:s="0"}=t;if(a){const t=a.startsWith("a_")?"gif":"png";return`https://cdn.discordapp.com/avatars/${e}/${a}.${t}?size=512`}return`https://cdn.discordapp.com/embed/avatars/${parseInt(s)%5}.png`}const statusColor=t=>({online:"#43d675",idle:"#f6c244",dnd:"#ef4444",offline:"#7b8894",invisible:"#7b8894"}[t]||"#7b8894");function assetUrl(t,e,a=128){return e?`https://cdn.discordapp.com/app-assets/${t}/${e}.png?size=${a}`:""}function updateProfileUI(t){const{discord_user:e,discord_status:a,activities:s=[],spotify:o,listening_to_spotify:n}=t,r=e?.username||"Unknown",i=e?.discriminator?`#${e.discriminator}`:"";$("#displayName").textContent=r,$("#tagline").textContent=i?`${i} • ${e.id}`:`ID: ${e.id}`;const l=document.createElement("img");l.src=avatarUrlFromLanyard(e),l.alt="avatar";const c=$("#pfp");c.innerHTML="",c.appendChild(l);const d=(a||"offline").toUpperCase();$("#statusText").textContent=d,$("#statusDot").style.background=statusColor(a);const u=t.active_on_discord?new Date(t.active_on_discord):null;$("#statusSince").textContent=u?`(${formatElapsed(Date.now()-u)})`:"";const m=$("#activityBlock");if(m.innerHTML="",n&&o){const{song:t,artist:e,album:a,album_art_url:s,timestamps:n}=o,r=n?.start?new Date(n.start):null,i=r?formatElapsed(Date.now()-r):"",l=el("div",{class:"spotify"},[el("div",{class:"sp-art"},[el("img",{src:s,alt:"album"})]),el("div",{class:"sp-meta"},[el("div",{class:"sp-song"},t||"Unknown"),el("div",{class:"sp-artist"},`${e||"Unknown"} — ${a||""}`),r&&el("div",{class:"act-timestamp"},`Started ${i} ago`)])]);m.appendChild(l)}else if(s.length){const t=s.find((t=>4!==t.type))||s[0];if(t){const{name:e,details:a,state:s,timestamps:o,assets:n,application_id:r}=t,i=o?.start?new Date(o.start):null,l=i?formatElapsed(Date.now()-i):"",c=el("div",{class:"activity"},[el("div",{class:"act-art"},n?.large_image?[el("img",{src:assetUrl(r,n.large_image,128),alt:"large"})]:[]),el("div",{class:"act-meta"},[el("div",{class:"act-name"},e||"Activity"),a&&el("div",{class:"act-details"},a),s&&el("div",{class:"act-details"},s),i&&el("div",{class:"act-timestamp"},`Playing for ${l}`)])]);if(n?.small_image){const t=el("div",{class:"act-asset","data-text":n.small_text||""},[el("img",{src:assetUrl(r,n.small_image,64)})]),e=el("div",{class:"act-assets"},[t]);c.appendChild(e)}m.appendChild(c)}}else m.appendChild(el("div",{class:"muted"},"No active activity"))}(async()=>{await loadQuotes(),await fetchLanyard(),setInterval(fetchLanyard,15e3)})(),document.body.addEventListener("keydown",(t=>{"Space"===t.code&&(t.preventDefault(),showRandomQuote())}));